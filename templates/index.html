<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>インテリジェントウインドウシステム</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🪟</text></svg>">
    <!-- 外部CSSファイル (static/style.css) を読み込む -->
    <!-- url_for を使って、Flaskが正しいパスを生成するようにする -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- 画面全体のコンテナ -->
    <div class="container">
        <h1>インテリジェントウィンドウ管理</h1>
        
        <!-- === ステータス表示エリア === -->
        <div class="status-display">
            <!-- ステータス表示グリッド (3列) -->
            <div class="status-grid">
                <!-- 各ステータス項目 -->
                <div class="status-item">
                    <div class="label">カーテン</div>
                    <span id="curtain-pos-value" class="value">--</span>
                    <span id="curtain-pos-unit">%</span>
                </div>
                <div class="status-item">
                    <div class="label">ﾌﾟﾛｼﾞｪｸﾀｰ</div>
                    <span id="projector-status" class="value">--</span>
                </div>
                <div class="status-item">
                    <div class="label">入力</div>
                    <span id="hdmi-status" class="value">--</span>
                </div>
                <div class="status-item">
                    <div class="label">モデル学習</div>
                    <span id="logging-status" class="value">--</span>
                </div>
                <div class="status-item">
                    <div class="label">モード</div>
                    <span id="control-mode" class="value">--</span>
                </div>
                <div class="status-item">
                    <div class="label">AIサーバー</div>
                    <span id="ai-status" class="value">--</span>
                </div>
            </div>
            <div id="countdown-area" style="margin-top: 15px; text-align: right; font-size: 12px; color: #768390; border-top: 1px solid #444c56; padding-top: 5px;">
                AIサーバーデータ送信：<span id="ai-timer">--分--秒後</span>
            </div>
        </div>
        
        <!-- === 操作モード切替 === -->
        <h2>操作モード</h2>
        <div class="controls-grid">
            <!-- onclick属性で、クリック時にJavaScriptのsetMode関数を呼び出す -->
            <button class="btn" onclick="setMode('auto')">自動(AI)</button>
            <button class="btn" onclick="setMode('manual')">手動</button>
        </div>
        
        <!-- === カーテン操作 === -->
        <h2>ハニカムシェードカーテン操作</h2>
        
        <div class="scene-group group-day">
            <div class="group-header">
                <span class="group-icon">☀</span> 採光モード <span class="group-sub">(ロールスクリーン全開/プロジェクターOFF)</span>
            </div>
            <div class="scene-buttons day-grid">
                <button class="scene-btn" data-scene="set0">
                    <span class="scene-percent">0%</span>
                    <span class="scene-subtext">シェード全開</span>
                    <span class="badge red">映像OFF</span>
                </button>
                <button class="scene-btn" data-scene="set25">
                    <span class="scene-percent">25%</span>
                    <span class="scene-subtext">シェード25%閉</span>
                    <span class="badge red">映像OFF</span>
                </button>
            </div>
        </div>

        <div class="scene-group group-window">
            <div class="group-header">
                <span class="group-icon">🪟</span> 疑似ウィンドウモード <span class="group-sub">(ロールスクリーン40%閉/プロジェクターON)</span>
            </div>
            <div class="scene-buttons window-grid">
                <button class="scene-btn" data-scene="set50">
                    <span class="scene-percent">50%</span>
                    <span class="scene-subtext">シェード半開</span>
                    <span class="badge blue">映像ON</span>
                </button>
                <button class="scene-btn" data-scene="set75">
                    <span class="scene-percent">75%</span>
                    <span class="scene-subtext">シェード75%閉</span>
                    <span class="badge blue">映像ON</span>
                </button>
                <button class="scene-btn" data-scene="set100">
                    <span class="scene-percent">100%</span>
                    <span class="scene-subtext">シェード全閉</span>
                    <span class="badge blue">映像ON</span>
                </button>
            </div>
        </div>
        
        <!-- === その他操作 === -->
        <h2>その他</h2>
        <!-- プロジェクター電源 -->
        <div class="controls-grid">
            <button class="btn" onclick="sendProjectorCommand('off')">ﾌﾟﾛｼﾞｪｸﾀｰ OFF</button>
            <button class="btn" onclick="sendProjectorCommand('on')">ﾌﾟﾛｼﾞｪｸﾀｰ ON</button>
        </div>
        <!-- HDMI入力切替 -->
        <div class="controls-grid" style="margin-top:10px;">
            <button class="btn" onclick="sendHdmiCommand('hdmi1')">HDMI 1<br><span class="subtext">ChromeCast</br>（動画配信サービス）</span></button>
            <button class="btn" onclick="sendHdmiCommand('hdmi2')">HDMI 2<br><span class="subtext">RaspberryPi</br>（リアルタイム映像）</span></button>
        </div>
        <!-- モデル学習モード切替 -->
        <div class="controls-grid" style="margin-top:10px;">
            <button class="btn" onclick="setLogging('off')">モデル学習 OFF</button>
            <button class="btn" onclick="setLogging('on')">モデル学習 ON</button>
        </div>
        
        <!-- === フッターリンク === -->
        <div class="footer-link">
            <!-- /log ページ (ログ表示) へのリンク -->
            <a href="/log" target="_blank">操作ログを表示</a>
        </div>
    </div>
    
    <!-- 外部JavaScriptファイル (static/script.js) を読み込む -->
    <!-- defer属性で、HTMLパース後に実行するようにする -->
    <script src="{{ url_for('static', filename='script.js') }}" defer></script>
</body>
</html>